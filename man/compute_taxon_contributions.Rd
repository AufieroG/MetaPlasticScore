% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_taxon_contributions.R
\name{compute_taxon_contributions}
\alias{compute_taxon_contributions}
\title{Compute per-taxon contributions to enzyme load per sample}
\usage{
compute_taxon_contributions(
  taxon_enzyme_matrix,
  abundance_df,
  normalize_abundance = TRUE
)
}
\arguments{
\item{taxon_enzyme_matrix}{Numeric matrix rows = taxa, cols = enzymes.}

\item{abundance_df}{Data.frame or matrix rows = taxa, cols = samples.}

\item{normalize_abundance}{Logical. If 'TRUE' perform column-wise TSS such that
each sample column sums to 1 (relative contributions). If 'FALSE' use
abundances as provided (absolute contributions).}
}
\value{
A list with elements:
\itemize{
\item 'contributions' : numeric matrix rows = taxa, cols = samples (taxon × sample contribution)
\item 'enzyme_load'   : numeric vector (named) enzyme load per taxon
}
}
\description{
Multiply taxon-level enzyme load by taxon abundance per sample to compute
a taxon × sample contribution matrix. Optionally normalize abundances to
relative proportions (Total Sum Scaling) before multiplication.
}
\details{
When 'normalize_abundance = TRUE', abundances are converted to proportions
via 'A <- sweep(A, 2, colSums(A), "/")'. This corresponds to library-size
normalization. Use 'TRUE' when you want comparisons of relative
contributions across samples; use 'FALSE' to preserve absolute counts.
}
\examples{
# contrib_res <- compute_taxon_contributions(taxon_enzyme_mat, abundance, TRUE)

}
