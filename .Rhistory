devtools::load_all()
install.packages(c("stats", "utils", "ggplot2", "vegan", "tidyr",
"circlize", "grid", "ggrepel", "viridis",
"RColorBrewer", "magrittr", "dplyr", "devtools"))
# Install Bioconductor packages
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ComplexHeatmap")
devtools::install_github("AufieroG/MetaPlasticScore")
setwd("C:/Users/gaeta/Desktop/Metagenomics/Prova")
library("MetaPlasticScore")
extdata_path <- system.file("extdata", package = "PlasticScore")
extdata_path <- system.file("extdata", package = "MetaPlasticScore")
expect_true(dir.exists(extdata_path))
hmm_dir <- file.path(extdata_path, "hmmsearch")
abundance_csv <- file.path(extdata_path, "Abbundance_simulated.csv")
metadata_groups_csv <- file.path(extdata_path, "Metadata_groups.csv")
metadata_taxa_csv <- file.path(extdata_path, "Metadata_taxa.csv")
# run the pipeline on example data
result <- run_PlasticScore(
hmmsearch_files = hmm_dir,
abundance_csv = abundance_csv,
metadata_groups_csv = metadata_groups_csv,
metadata_taxa_csv = metadata_taxa_csv,
min_hmm_coverage = 0.7,
max_dom_bias = 0.1,
enzymes_for_plastic = "All",
method = "abundance",
normalize_abundance = FALSE
)
extdata_path <- system.file("extdata", package = "MetaPlasticScore")
expect_true(dir.exists(extdata_path))
extdata_path
expect_true
hmm_dir <- file.path(extdata_path, "hmmsearch")
abundance_csv <- file.path(extdata_path, "Abbundance_simulated.csv")
metadata_groups_csv <- file.path(extdata_path, "Metadata_groups.csv")
metadata_taxa_csv <- file.path(extdata_path, "Metadata_taxa.csv")
abundance_csv
result <- run_PlasticScore(
hmmsearch_files = hmm_dir,
abundance_csv = abundance_csv,
metadata_groups_csv = metadata_groups_csv,
metadata_taxa_csv = metadata_taxa_csv,
min_hmm_coverage = 0.7,
max_dom_bias = 0.1,
enzymes_for_plastic = "All",
method = "abundance",
normalize_abundance = FALSE
)
# run the pipeline on example data
result <- run_PlasticScore(
hmmsearch_files = hmm_dir,
abundance_csv = abundance_csv,
metadata_groups_csv = metadata_groups_csv,
metadata_taxa_csv = metadata_taxa_csv,
min_hmm_coverage = 0.7,
max_dom_bias = 0.1,
enzymes_for_plastic = "All",
method = "abundance",
normalize_abundance = FALSE
)
result <- run_PlasticScore(
hmmsearch_files = hmm_dir,
abundance_csv = abundance_csv,
metadata_groups_csv = metadata_groups_csv,
metadata_taxa_csv = metadata_taxa_csv,
min_hmm_coverage = 0.7,
max_dom_bias = 0.1,
enzymes_for_plastic = "All",
method = "abundance",
normalize_abundance = FALSE
)
hmm_dir <- file.path(extdata_path, "hmmsearch")
abundance_csv <- file.path(extdata_path, "Abundance_simulated.csv")
metadata_groups_csv <- file.path(extdata_path, "Metadata_groups.csv")
metadata_taxa_csv <- file.path(extdata_path, "Metadata_taxa.csv")
result <- run_PlasticScore(
hmmsearch_files = hmm_dir,
abundance_csv = abundance_csv,
metadata_groups_csv = metadata_groups_csv,
metadata_taxa_csv = metadata_taxa_csv,
min_hmm_coverage = 0.7,
max_dom_bias = 0.1,
enzymes_for_plastic = "All",
method = "abundance",
normalize_abundance = FALSE
)
# Filtered HMMER hits retained after coverage and domain-bias filtering
hits_filt <- result$hits_filt
# PlasticScore computed for each sample
plastic_score <- result$plastic_score
# Enzyme load per taxon (number or abundance-weighted count of plastic-degrading enzymes)
enzyme_load <- result$enzyme_load
# Taxon × enzyme matrix (presence / counts / abundance-weighted values)
taxon_enzyme_mat <- result$taxon_enzyme_mat
# Per-taxon summary statistics and contribution metrics
taxon_stats <- result$taxon_stats
# Abundance table actually used in the analysis (raw or normalized)
abundance <- result$abundance
# Sample metadata (e.g. experimental groups such as STD and PE)
metadata_groups <- result$metadata_groups
# Taxonomic metadata used for aggregation (e.g. Phylum)
metadata_taxa <- result$metadata_taxa
# Enzyme abundance aggregated at the sample level
enzyme_by_sample <- result$enzyme_by_sample
# Contribution of each phylum to the PlasticScore or enzyme load
contrib_phylum_mat <- result$contrib_phylum_mat
# Phylum × enzyme matrix (enzyme profiles aggregated by phylum)
phylum_enzyme_mat <- result$phylum_enzyme_mat
# Long-format table of enzyme abundances grouped by phylum (tidy format)
df_phylum_enzyme <- result$df_phylum_enzyme
plot_PlasticScore(
df_phylum_enzyme = df_phylum_enzyme,
taxon_enzyme_mat = taxon_enzyme_mat,
phylum_enzyme_mat = phylum_enzyme_mat,
enzyme_by_sample = enzyme_by_sample,
plastic_score = plastic_score,
contrib_phylum_mat = contrib_phylum_mat,
meta = metadata_groups,
meta_taxa = metadata_taxa,
sample_col = "Samples",
condition_col = "Groups"
)
?MetaPlasticScore
??MetaPlasticScore
setwd("C:/Users/gaeta/Desktop/Metagenomics/MetaPlasticScore")
devtools::load_all()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::load_all()
devtools::document()
devtools::check()
devtools::load_all()
devtools::document()
devtools::check()
devtools::load_all()
devtools::document()
devtools::check()
devtools::load_all()
devtools::document()
devtools::check()
devtools::load_all()
devtools::document()
devtools::check()
devtools::load_all()
devtools::document()
devtools::load_all()
devtools::document()
devtools::check()
