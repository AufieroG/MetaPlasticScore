% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_MetaPlasticScore.R
\name{run_MetaPlasticScore}
\alias{run_MetaPlasticScore}
\title{Run MetaPlasticScore pipeline}
\usage{
run_MetaPlasticScore(
  hmmsearch_files,
  abundance_csv,
  metadata_groups_csv,
  metadata_taxa_csv,
  sample_col = NULL,
  condition_col = NULL,
  min_hmm_coverage = 0.7,
  max_dom_bias = 0.1,
  enzymes_for_plastic = "All",
  method = c("abundance", "binary"),
  normalize_abundance = TRUE
)
}
\arguments{
\item{hmmsearch_files}{Character(1). Directory containing '.tbl' / '.domtbl' files.}

\item{abundance_csv}{Character(1). Path to a CSV file with rows = taxa (rownames), cols = samples.}

\item{metadata_groups_csv}{Character(1). CSV containing sample metadata (first column = sample IDs).}

\item{metadata_taxa_csv}{Character(1). CSV mapping 'taxon_id' to taxonomic fields (e.g., Phylum).}

\item{sample_col}{Optional character(1). Column name in 'metadata_groups_csv' with sample IDs (default = first column).}

\item{condition_col}{Optional character(1). Column name in 'metadata_groups_csv' with group labels (default = second column).}

\item{min_hmm_coverage}{Numeric. See 'filter_hmm_hits'.}

\item{max_dom_bias}{Numeric. See 'filter_hmm_hits'.}

\item{enzymes_for_plastic}{Character vector or "All". Subset of enzymes to use when scoring.}

\item{method}{Character. '"abundance"' or '"binary"'.}

\item{normalize_abundance}{Logical. Passed to 'compute_taxon_contributions' (TSS if TRUE).}
}
\value{
A list (class 'MetaPlasticScoreResult') containing:
\itemize{
\item 'hits_filt', 'taxon_enzyme_mat', 'plastic_score', 'plastic_score_test',
'enzyme_load', 'taxon_stats', 'abundance', 'metadata_groups', 'metadata_taxa',
and plot-ready objects 'df_phylum_enzyme', 'phylum_enzyme_mat', 'enzyme_by_sample',
'contrib_phylum_mat'.
}
}
\description{
Wrapper that executes the workflow:
parse HMMER outputs, filter hits, build taxon√ó enzyme matrix, compute plastic
scores, compute taxon contributions, run per-taxon tests and prepare objects
for plotting.
}
\details{
This wrapper assumes standard input layouts:
\itemize{
\item 'abundance_csv' should have taxa as rownames and sample IDs as column names.
\item 'metadata_groups_csv' first two columns are sample ID and group label.
\item 'metadata_taxa_csv' should map 'taxon_id' to taxonomic ranks such as 'Phylum'.
}

Use 'normalize_abundance = TRUE' to get taxon contributions expressed as
proportions (TSS). Use 'FALSE' to preserve absolute abundances.
}
\examples{
\dontrun{
result <- run_MetaPlasticScore("hmmsearch", "abundance.csv", "metadata_samples.csv", "metadata_taxa.csv")
}

}
