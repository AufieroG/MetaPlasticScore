% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parse_hmmsearch_tbl.R
\name{parse_hmmsearch_tbl}
\alias{parse_hmmsearch_tbl}
\title{Parse hmmsearch domtbl/tbl outputs into a data.frame of hits}
\usage{
parse_hmmsearch_tbl(files)
}
\arguments{
\item{files}{Character vector. Paths to '.tbl' or '.domtbl' files.}
}
\value{
A data.frame containing parsed columns for each hit:
\itemize{
\item 'target_name', 'tlen', 'query_name', 'qlen', 'full_evalue', 'full_score',
'dom_num', 'dom_of', 'i_evalue', 'dom_score', 'dom_bias', 'hmm_from',
'hmm_to', 'ali_from', 'ali_to', 'description', 'taxon_id', 'enzyme_id',
'source_file', 'hmm_coverage', 'target_coverage', 'hit_id'.
}
}
\description{
Read a set of 'domtbl'/'tbl' files produced by HMMER (hmmsearch) and parse
the main tabular fields into a single data.frame. Files are expected to be
named following '<taxon_id>__<enzyme_id>.tbl' (or '.domtbl') so taxon and
enzyme identifiers can be inferred automatically.
}
\details{
The function:
\itemize{
\item reads each file line-by-line,
\item skips comment lines beginning with '#',
\item tokenizes fields by whitespace,
\item constructs numeric columns with 'suppressWarnings(as.numeric(...))' to
avoid hard failures on occasional non-numeric fields,
\item computes 'hmm_coverage = (hmm_to - hmm_from + 1) / qlen' and
'target_coverage = (ali_to - ali_from + 1) / tlen',
\item attaches 'taxon_id' and 'enzyme_id' inferred from filename.
}
}
\examples{
# files <- list.files("hmmsearch", pattern = "\\.(domtbl|tbl)$", full.names = TRUE)
# hits_df <- parse_hmmsearch_tbl(files)

}
