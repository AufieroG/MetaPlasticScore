% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_plastic_score.R
\name{compute_plastic_score}
\alias{compute_plastic_score}
\title{Compute sample-level plastic degradation potential score}
\usage{
compute_plastic_score(
  taxon_enzyme_matrix,
  abundance_df,
  enzymes_for_plastic = "All",
  method_counting_enzyme = c("abundance", "binary"),
  normalize_taxa_abundance = FALSE
)
}
\arguments{
\item{taxon_enzyme_matrix}{Numeric matrix rows = taxa, cols = enzymes.
Row names must match taxon IDs used in 'abundance_df'.}

\item{abundance_df}{Data.frame or matrix with rows = taxa, cols = samples.
Row names must be taxon IDs.}

\item{enzymes_for_plastic}{Character vector of enzyme IDs to include or 'All'.}

\item{method_counting_enzyme}{Character, one of 'abundance' (default) or 'binary'.
\itemize{
\item 'abundance': use number of enzyme targets (load) as multiplier of abundance.
\item 'binary': treat each taxon-enzyme presence as 0/1 when computing load.
}}

\item{normalize_taxa_abundance}{Logical (FALSE) to normalize abundance by simple division by the total count. Default (FALSE).
each sample column sums to 1 (relative contributions). If 'FALSE' use
abundances as provided (absolute contributions).
Skip normalization (set FALSE) when counts are already normalized.}
}
\value{
Named numeric vector of scores (names = sample IDs).
}
\description{
Compute a per-sample score representing the potential for plastic degradation
given a taxon × enzyme matrix and a taxon abundance table.
}
\details{
Steps:
\enumerate{
\item Intersect taxa between 'taxon_enzyme_matrix' and 'abundance_df'.
\item Optionally subselect enzymes via 'enzymes_for_plastic'.
\item If 'method = binary', convert enzyme counts to presence/absence per taxon.
\item Compute enzyme load per taxon as row sums of the enzyme matrix.
\item Score each sample as sum over taxa of (abundance × enzyme_load).
}

Interpretation notes:
\itemize{
\item If 'abundance_df' is library-size normalized (e.g., columns sum = 1),
the score is relative. If abundances are absolute read counts, the score is
absolute and depends on library size.
\item Consider normalizing abundance consistently across samples if you intend to
compare scores between samples. Skip normalization (set FALSE) when counts are already normalized.
}
}
\examples{
# score <- ccompute_plastic_score(agg_mat, abundance, method_counting_enzyme = "abundance", normalize_taxa_abundance = FALSE)

}
